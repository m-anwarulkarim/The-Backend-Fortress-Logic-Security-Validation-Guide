# ЁЯЪА The Backend Fortress: Logic, Security & Validation Guide

ржПржЗ ржбржХрзБржорзЗржирзНржЯрзЗрж╢ржиржЯрж┐ ржбрзЗржнрзЗрж▓ржкрж╛рж░ржжрзЗрж░ ржЬржирзНржп ржмрзНржпрж╛ржХрзЗржПржирзНржб рж▓ржЬрж┐ржХ ржПрж░ ржПржХржЯрж┐ ржкрзВрж░рзНржгрж╛ржЩрзНржЧ рж░рзЛржбржорзНржпрж╛ржк, ржпрж╛ ржЕржирзБрж╕рж░ржг ржХрж░рж▓рзЗ ржЖржкржирж┐ ржПржХржЯрж┐ ржирж┐рж░рж╛ржкржж ржПржмржВ рж╕рзНржХрзЗрж▓рзЗржмрж▓ ржмрзНржпрж╛ржХржПржирзНржб ржЖрж░рзНржХрж┐ржЯрзЗржХржЪрж╛рж░ рждрзИрж░рж┐ ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржиред рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж┐ржВ ржерзЗржХрзЗ рж╢рзБрж░рзБ ржХрж░рзЗ ржбрзЗржЯрж╛ржмрзЗржЬ ржЕржкрж╛рж░рзЗрж╢ржи ржкрж░рзНржпржирзНржд ржкрзНрж░рждрж┐ржЯрж┐ ржзрж╛ржкрзЗрж░ ржкрзНрж░рзЛржЯрзЗржХрж╢ржи рж▓ржЬрж┐ржХ ржПржЦрж╛ржирзЗ ржжрзЗржУрзЯрж╛ рж╣рзЯрзЗржЫрзЗред

## middlewares

### ЁЯУЪ Topics Covered

| No. | Topic                               | Link                            |
| --- | ----------------------------------- | ------------------------------- |
| 01  | ЁЯФП Auth Guard-ржПрж░ рзнржЯрж┐ ржзрж╛ржк            | [View](./middlewares/README.md) |
| 02  | ЁЯФП _req.user ржЯрж╛ржЗржк ржбрж┐ржХрзНрж▓рзЗрзЯрж╛рж░_        | [View](./middlewares/README.md) |
| 03  | ЁЯФП Usage in Routes                  | [View](./middlewares/README.md) |
| 04  | ЁЯФП _Logout ржХрж░рзЗ ржЯрзЛржХрзЗржи blacklist ржХрж░рж╛_ | [View](./middlewares/README.md) |
| 05  | ЁЯФП `checkRedisBlacklist()` ржлрж╛ржВрж╢ржи    | [View](./middlewares/README.md) |
| 06  | ЁЯФП Comming Soon...                  | [View](./middlewares/)          |
| 07  | ЁЯФП Comming Soon...                  | [View](./middlewares/)          |
| 08  | ЁЯФП Comming Soon...                  | [View](./middlewares/)          |
| 09  | ЁЯФП Comming Soon...                  | [View](./middlewares/)          |
| 10  | ЁЯФП Comming Soon...                  | [View](./middlewares/)          |

---

## ЁЯЫая╕П ржЯрзЗржХржирзЛрж▓ржЬрж┐ рж╕рзНржЯрзНржпрж╛ржХ

ржПржЗ ржЧрж╛ржЗржбрзЗрж░ ржЙржжрж╛рж╣рж░ржгржЧрзБрж▓рзЛ ржорзВрж▓ржд **Node.js, Express, TypeScript ржПржмржВ Prisma**-рж░ ржУржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ рждрзИрж░рж┐, рждржмрзЗ ржорзВрж▓ ржХржирж╕рзЗржкрзНржЯржЧрзБрж▓рзЛ ржпрзЗржХрзЛржирзЛ рж▓рзНржпрж╛ржЩрзНржЧрзБрзЯрзЗржЬ ржмрж╛ ржлрзНрж░рзЗржоржУрзЯрж╛рж░рзНржХрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╕ржорзНржнржмред

---

## ЁЯФР рзз. Authentication (ржЗржЙржЬрж╛рж░ ржХрж┐ рж▓ржЧржЗржи ржХрж░рж╛?)

ржПржЯрж┐ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯрзЗрж░ ржПржХржжржо рж╢рзБрж░рзБрждрзЗ **Middleware** рж╣рж┐рж╕рзЗржмрзЗ ржХрж╛ржЬ ржХрж░рзЗред

- **ржХржЦржи ржЬрж░рзБрж░рж┐:** ржкрзНрж░рж╛ржЗржнрзЗржЯ ржЕрзНржпрж╛ржХрж╢ржи (ржпрзЗржоржи: ржкрзЛрж╕рзНржЯ рждрзИрж░рж┐, ржкрзНрж░рзЛржлрж╛ржЗрж▓ ржЖржкржбрзЗржЯ) ржХрж░рж╛рж░ рж╕ржорзЯред
- **ржХрзА ржЪрзЗржХ ржХрж░рждрзЗ рж╣ржмрзЗ:** - ржЯрзЛржХрзЗржи (JWT) рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ рж╣рзЗржбрж╛рж░рзЗ ржЖржЫрзЗ ржХрж┐ ржирж╛ред
- ржЯрзЛржХрзЗржиржЯрж┐ ржнрзНржпрж╛рж▓рж┐ржб ржПржмржВ ржПрж░ ржорзЗрзЯрж╛ржж (Expiration) ржЖржЫрзЗ ржХрж┐ ржирж╛ред

## ЁЯФС рзи. Authorization (ржЗржЙржЬрж╛рж░рзЗрж░ ржХрж┐ ржПржЗ ржХрж╛ржЬ ржХрж░рж╛рж░ ржЕржирзБржорждрж┐ ржЖржЫрзЗ?)

- **ржХржЦржи ржЬрж░рзБрж░рж┐:** ржЕрзНржпрж╛ржбржорж┐ржи ржкрзНржпрж╛ржирзЗрж▓рзЗ ржПржХрзНрж╕рзЗрж╕ ржмрж╛ ржЕржирзНржпрзЗрж░ ржбрзЗржЯрж╛ ржПржбрж┐ржЯ ржХрж░рж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рж▓рзЗред
- **ржХрзА ржЪрзЗржХ ржХрж░рждрзЗ рж╣ржмрзЗ:** - **Role-Based:** ржЗржЙржЬрж╛рж░ ржХрж┐ Admin ржирж╛ржХрж┐ рж╕рж╛ржзрж╛рж░ржг User?
- **Ownership:** ржЗржЙржЬрж╛рж░ ржХрж┐ ржирж┐ржЬрзЗрж░ ржбрзЗржЯрж╛ ржЖржкржбрзЗржЯ ржХрж░ржЫрзЗ? (ржЙржжрж╛: `post.authorId === user.id`)ред

---

## ЁЯЫая╕П рзй. CRUD ржЕржкрж╛рж░рзЗрж╢ржирзЗ ржЬрж░рзБрж░рж┐ ржЪрзЗржХржЧрзБрж▓рзЛ

### ЁЯУЭ Create (ржирждрзБржи ржбрзЗржЯрж╛ рждрзИрж░рж┐)

- **Controller:** - рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржмржбрж┐ ржЦрж╛рж▓рж┐ ржХрж┐ ржирж╛ред
- `Required Fields` (ржпрзЗржоржи: Title, Content) ржЖржЫрзЗ ржХрж┐ ржирж╛ред
- ржЯрж╛ржЗржк ржЪрзЗржХ (String ржХрж┐ ржирж╛, Number ржХрж┐ ржирж╛)ред

- **Service:** - **Uniqueness:** ржЗржорзЗржЗрж▓ ржмрж╛ ржЯрж╛ржЗржЯрзЗрж▓ ржХрж┐ ржЖржЧрзЗ ржерзЗржХрзЗржЗ ржбрзЗржЯрж╛ржмрзЗржЬрзЗ ржЖржЫрзЗ?
- **Limit:** ржЗржЙржЬрж╛рж░ ржХрж┐ ржжрж┐ржирзЗ рж╕рж░рзНржмрзЛржЪрзНржЪ ржкрзЛрж╕рзНржЯ ржХрж░рж╛рж░ рж╕рзАржорж╛ ржЕрждрж┐ржХрзНрж░ржо ржХрж░рзЗржЫрзЗ?

### ЁЯУЦ Read (ржбрзЗржЯрж╛ ржкрзЬрж╛)

- **Controller:** - ржЖржЗржбрж┐ (ID) ржлрж░ржорзНржпрж╛ржЯ рж╕ржарж┐ржХ ржХрж┐ ржирж╛ (UUID ржмрж╛ ObjectId ржЪрзЗржХ)ред
- **Service:** - **Existence:** ржбрзЗржЯрж╛ржмрзЗржЬрзЗ ржПржЗ ржЖржЗржбрж┐ ржжрж┐рзЯрзЗ ржХрж┐ржЫрзБ ржкрж╛ржУрзЯрж╛ ржЧрзЗрж▓ ржХрж┐ ржирж╛? (ржирж╛ ржкрзЗрж▓рзЗ `404 Not Found`)ред
- **Status:** ржбрзЗржЯрж╛ржЯрж┐ ржХрж┐ `isDeleted: true` ржЕржмрж╕рзНржерж╛рзЯ ржЖржЫрзЗ?

### ЁЯФД Update (ржбрзЗржЯрж╛ ржкрж░рж┐ржмрж░рзНрждржи)

- **Controller:** - ржЖржкржбрзЗржЯ ржХрж░рж╛рж░ ржбрзЗржЯрж╛ржЧрзБрж▓рзЛ ржнрзНржпрж╛рж▓рж┐ржб ржХрж┐ ржирж╛ред
- **Service:** - **Check First:** ржЖржЧрзЗ ржЪрзЗржХ ржХрж░рзБржи ржбрзЗржЯрж╛ржЯрж┐ ржбрзЗржЯрж╛ржмрзЗржЬрзЗ ржЖржЫрзЗ ржХрж┐ ржирж╛ред
- **Conflict:** ржирждрзБржи ржирж╛ржо ржмрж╛ ржЗржорзЗржЗрж▓ ржжрж┐рж▓рзЗ рж╕рзЗржЯрж┐ ржЕржирзНржп ржХрзЗржЙ ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржЫрзЗ ржХрж┐ ржирж╛ред
- **Owner Check:** ржЗржЙржЬрж╛рж░ ржХрж┐ рж╢рзБржзрзБ ржирж┐ржЬрзЗрж░ ржбрзЗржЯрж╛ржЗ ржЖржкржбрзЗржЯ ржХрж░рж╛рж░ ржЕржирзБржорждрж┐ рж░рж╛ржЦрзЗ?

### ЁЯЧСя╕П Delete (ржбрзЗржЯрж╛ ржорзБржЫрзЗ ржлрзЗрж▓рж╛)

- **Controller:** ржЖржЗржбрж┐ ржлрж░ржорзНржпрж╛ржЯ ржЪрзЗржХред
- **Service:** - **Dependency:** ржПржЗ ржбрзЗржЯрж╛ ржбрж┐рж▓рж┐ржЯ ржХрж░рж▓рзЗ ржХрж┐ ржЕржирзНржп ржХрзЛржерж╛ржУ рж╕ржорж╕рзНржпрж╛ рж╣ржмрзЗ? (ржЙржжрж╛: ржХрзНржпрж╛ржЯрж╛ржЧрж░рж┐ ржбрж┐рж▓рж┐ржЯ ржХрж░рж▓рзЗ рждрж╛рж░ ржкрзЛрж╕рзНржЯржЧрзБрж▓рзЛрж░ ржХрзА рж╣ржмрзЗ?)ред
- **Soft Delete:** рж╕рж░рж╛рж╕рж░рж┐ ржбрж┐рж▓рж┐ржЯ ржирж╛ ржХрж░рзЗ `isDeleted: true` ржЖржкржбрзЗржЯ ржХрж░рж╛ред

---

## ЁЯЪА рзл. ржПржХ ржиржЬрж░рзЗ ржлрзНрж▓рзЛ (Workflow Summary)

рзз. **Request ржЖрж╕рзЗ** тмЗя╕П

рзи. **Authentication** (ржЯрзЛржХрзЗржи ржнрзЗрж░рж┐ржлрж┐ржХрзЗрж╢ржи)

рзй. **Authorization** (ржкрж╛рж░ржорж┐рж╢ржи ржУ ржУржирж╛рж░рж╢рж┐ржк ржЪрзЗржХ)

рзк. **Controller Validation** (ржЯрж╛ржЗржк ржУ ржлрж░ржорзНржпрж╛ржЯ ржЪрзЗржХ)

рзл. **Service Logic** (ржЕрж╕рзНрждрж┐рждрзНржм ржУ ржбрзБржкрзНрж▓рж┐ржХрзЗржЯ ржЪрзЗржХ)

рзм. **Database Operation** (ржбрзЗржЯрж╛ рж╕рзЗржн ржмрж╛ ржбрж┐рж▓рж┐ржЯ)

---

## тЪая╕П рзм. ржПрж░рж░ рж╣рзНржпрж╛ржирзНржбрж▓рж┐ржВ (Error Codes)

рж╕ржарж┐ржХ ржПрж░рж░ ржХрзЛржб ржжрзЗржУрзЯрж╛ ржПржХржЬржи ржкрзНрж░ржлрзЗрж╢ржирж╛рж▓ ржбрзЗржнрзЗрж▓ржкрж╛рж░рзЗрж░ ржкрж░рж┐ржЪрзЯ:

- `400 Bad Request`: ржнрзБрж▓ ржмрж╛ ржЗржиржнрзНржпрж╛рж▓рж┐ржб ржЗржиржкрзБржЯред
- `401 Unauthorized`: рж▓ржЧржЗржи ржХрж░рж╛ ржирзЗржЗред
- `403 Forbidden`: ржкрж╛рж░ржорж┐рж╢ржи ржирзЗржЗред
- `404 Not Found`: ржбрзЗржЯрж╛ ржЦрзБржБржЬрзЗ ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯржирж┐ред
- `409 Conflict`: ржбрзБржкрзНрж▓рж┐ржХрзЗржЯ ржбрзЗржЯрж╛ ржмрж╛ ржХржиржлрзНрж▓рж┐ржХрзНржЯред

---

> [!TIP] > **рж╕рзЗрж░рж╛ ржкрзНрж░рзНржпрж╛ржХржЯрж┐рж╕:** ржЗржиржкрзБржЯ ржнрзНржпрж╛рж▓рж┐ржбрзЗрж╢ржи ржПржмржВ ржЕржерзЗржирзНржЯрж┐ржХрзЗрж╢ржи рж╕ржмрж╛рж░ ржЖржЧрзЗ рж╢рзЗрж╖ ржХрж░рзБржиред ржбрж╛ржЯрж╛ржмрзЗржЬрзЗ рж╣рж╛ржд ржжрзЗржУрзЯрж╛рж░ ржЖржЧрзЗржЗ ржпржжрж┐ ржЖржкржирж┐ ржнрзБрж▓ ржзрж░рждрзЗ ржкрж╛рж░рзЗржи, рждржмрзЗ ржЖржкржирж╛рж░ рж╕рж╛рж░рзНржнрж╛рж░ ржлрж╛рж╕рзНржЯ ржПржмржВ ржирж┐рж░рж╛ржкржж ржерж╛ржХржмрзЗред

ржирж┐ржЪрзЗрж░ржнрж╛ржмрзЗ ржарж┐ржХржнрж╛ржмрзЗ, ржмрж╛ржВрж▓рж╛рзЯ рж╕рзБржирзНржжрж░ржнрж╛ржмрзЗ ржПржмржВ ржкрж░рзНржпрж╛рзЯржХрзНрж░ржорзЗ рж╕рж╛ржЬрж╛ржирзЛ рж╣рж▓рзЛ:
