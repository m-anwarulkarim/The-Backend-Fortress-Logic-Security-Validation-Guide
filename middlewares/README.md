# ЁЯЫбя╕П Middlewares Layer (ржирж┐рж░рж╛ржкрждрзНрждрж╛ ржУ ржкрж╛рж╣рж╛рж░рж╛ржжрж╛рж░ рж╕рзНрждрж░)

## ЁЯУМ ржкрж░рж┐ржЪрж┐рждрж┐

ржорж┐ржбрж▓ржУрзЯрзНржпрж╛рж░ рж╣рж▓рзЛ ржЕрзНржпрж╛ржкрзНрж▓рж┐ржХрзЗрж╢ржирзЗрж░ ржПржХржЯрж┐ **"ржЪрзЗржХржкрзЛрж╕рзНржЯ"**ред ржХрзНрж▓рж╛ржпрж╝рзЗржирзНржЯ ржерзЗржХрзЗ ржЖрж╕рж╛ ржкрзНрж░рждрж┐ржЯрж┐ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ **Controller**-ржП ржпрж╛ржУржпрж╝рж╛рж░ ржЖржЧрзЗ ржПржЗ рж╕рзНрждрж░ ржЕрждрж┐ржХрзНрж░ржо ржХрж░рзЗред ржПрж░ ржХрж╛ржЬ рж╣рж▓рзЛтАФ

- ржирж┐рж░рж╛ржкрждрзНрждрж╛ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рж╛
- ржнрзБрж▓/ржЕрж╕ржорзНржкрзВрж░рзНржг рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржмрзНрж▓ржХ ржХрж░рж╛
- рж╕рж┐рж╕рзНржЯрзЗржоржХрзЗ ржЕржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ рж▓рзЛржб ржерзЗржХрзЗ рж░ржХрзНрж╖рж╛ ржХрж░рж╛

ржирж┐ржЪрзЗ **Auth Guard** ржпрзЗ ржкрзНрж░ржзрж╛ржи рзнржЯрж┐ ржзрж╛ржк ржЕржирзБрж╕рж░ржг ржХрж░рзЗ рждрж╛ ржжрзЗржЦрж╛ржирзЛ рж╣рж▓рзЛ (ржкрзНрж░рзЯрзЛржЬржирзЗ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рждрзЗ ржкрж╛рж░рзЗржи), _Usage in Routes_,:

---

## ЁЯФР Auth Guard-ржПрж░ рзнржЯрж┐ ржзрж╛ржк

1. **ржЯрзЛржХрзЗржи ржЧрзНрж░рж╣ржг (Token Extraction)**  
   рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ рж╣рзЗржбрж╛рж░рзЗрж░ `Authorization: Bearer <token>` ржерзЗржХрзЗ ржЯрзЛржХрзЗржи рж╕ржВржЧрзНрж░рж╣ ржХрж░рж╛ред

2. **ржЯрзЛржХрзЗржи ржЙржкрж╕рзНржерж┐рждрж┐ ржЪрзЗржХ (Presence Check)**  
   ржЯрзЛржХрзЗржи ржирж╛ ржерж╛ржХрж▓рзЗ рж╕рж╛ржерзЗ рж╕рж╛ржерзЗ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржмржирзНржз ржХрж░рж╛ рж╣рзЯред  
   **Status:** `401 Unauthorized`

3. **ржЯрзЛржХрзЗржи ржнрзЗрж░рж┐ржлрж┐ржХрзЗрж╢ржи (Token Verification)**  
   Server-ржПрж░ JWT Secret ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржпрж╛ржЪрж╛ржЗ ржХрж░рж╛ рж╣рзЯ ржЯрзЛржХрзЗржиржЯрж┐ ржмрзИржз ржХрж┐ ржирж╛ред

4. **ржмрзНрж▓рзНржпрж╛ржХрж▓рж┐рж╕рзНржЯрзЗржб ржЯрзЛржХрзЗржи ржЪрзЗржХ (Blacklist Check)**  
   рж▓ржЧржЖржЙржЯ ржХрж░рж╛ ржЯрзЛржХрзЗржи Redis-ржПрж░ ржмрзНрж▓рзНржпрж╛ржХрж▓рж┐рж╕рзНржЯрзЗ ржерж╛ржХрзЗред  
   ржЯрзЛржХрзЗржиржЯрж┐ ржмрзНрж▓рзНржпрж╛ржХрж▓рж┐рж╕рзНржЯрзЗ ржерж╛ржХрж▓рзЗ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржмрж╛рждрж┐рж▓ред

5. **ржЗржЙржЬрж╛рж░рзЗрж░ ржЕрж╕рзНрждрж┐рждрзНржм ржпрж╛ржЪрж╛ржЗ (User Existence Check)**  
   ржЯрзЛржХрзЗржи Valid рж╣рж▓рзЗржУ ржбрж╛ржЯрж╛ржмрзЗржЬрзЗ ржЗржЙржЬрж╛рж░ ржЦрзБржБржЬрзЗ ржжрзЗржЦрж╛ рж╣рзЯ ржпрзЗ ржЗржЙржЬрж╛рж░ ржПржЦржирзЛ Active ржЖржЫрзЗ ржХрж┐ ржирж╛ред

6. **рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯрзЗ ржбрзЗржЯрж╛ рж╕рзЗржЯ ржХрж░рж╛ (Attach User to Request)**  
   рж╕ржмржХрж┐ржЫрзБ ржарж┐ржХ рж╣рж▓рзЗ ржЗржЙржЬрж╛рж░рзЗрж░ рждржерзНржп `req.user` ржП рж╕рзЗржЯ ржХрж░рж╛ рж╣рзЯред

7. **рж░рзЛрж▓-ржмрзЗрж╕ржб ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржХржирзНржЯрзНрж░рзЛрж▓ (RBAC)**  
   ржЗржЙржЬрж╛рж░рзЗрж░ Role (Admin/User/Editor) ржЕржирзБржорждрж┐ ржирж╛ ржерж╛ржХрж▓рзЗ  
   **Status:** `403 Forbidden`

---

## ЁЯзР ржХрзЗржи ржорж┐ржбрж▓ржУрзЯрзНржпрж╛рж░ ржкрзНрж░рзЯрзЛржЬржи?

1. **ржирж┐рж░рж╛ржкрждрзНрждрж╛ (Authentication)** тАФ ржЗржЙржЬрж╛рж░ рж▓ржЧржЗржи ржХрж░рж╛ ржХрж┐ ржирж╛ ржЪрзЗржХ ржХрж░рж╛ред
2. **ржХрзНрж╖ржорждрж╛ ржпрж╛ржЪрж╛ржЗ (Authorization)** тАФ ржЗржЙржЬрж╛рж░рзЗрж░ ржХрж┐ ржЕржирзБржорждрж┐ ржЖржЫрзЗ рждрж╛ ржпрж╛ржЪрж╛ржЗ ржХрж░рж╛ред
3. **ржнрзНржпрж╛рж▓рж┐ржбрзЗрж╢ржи** тАФ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯрзЗрж░ ржбрзЗржЯрж╛/ржЯрзЛржХрзЗржи рж╕ржарж┐ржХ ржХрж┐ ржирж╛ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рж╛ред
4. **ржХрзЛржб рж░рж┐ржЗржЙржЬрзЗржмрж┐рж▓рж┐ржЯрж┐** тАФ ржмрж╛рж░ржмрж╛рж░ рж╕рж┐ржХрж┐ржЙрж░рж┐ржЯрж┐ рж▓ржЬрж┐ржХ ржирж╛ рж▓рж┐ржЦрзЗ ржПржХ ржЬрж╛ржпрж╝ржЧрж╛рзЯ рж░рж╛ржЦрж╛ред

---

## ЁЯЪж Middleware Workflow

```text
Client Request тЮбя╕П Middleware (ржЪрзЗржХржкрзЛрж╕рзНржЯ) тЮбя╕П next() тЮбя╕П Controller
```

# _тЬЕ 1) \*\*рж╕ржорзНржкрзВрж░рзНржг Auth Guard Middleware_

```ts
// src/middleware/authGuard.ts
import { Request, Response, NextFunction } from "express";
import jwt from "jsonwebtoken";
import { prisma } from "../lib/prisma";
import { checkRedisBlacklist } from "../utils/redis";

export const authGuard = (...Role: string[]) => {
  return async (req: Request, res: Response, next: NextFunction) => {
    try {
      // рзз. Token Extraction
      const token = req.headers.authorization?.split(" ")[1];
      if (!token) throw new Error("You are not logged in! | ржЖржкржирж┐ рж▓ржЧржЗржи ржХрж░рж╛ ржиржи!");

      // рзи. Blacklist ржЪрзЗржХ (рж▓ржЧржЖржЙржЯ ржмрж╛ ржкрж╛рж╕ржУрзЯрж╛рж░рзНржб ржЪрзЗржЮрзНржЬ рж╣рж▓рзЗ)
      const isBlacklisted = await checkRedisBlacklist(token);
      if (isBlacklisted)
        throw new Error(  "This token has been revoked! | ржПржЗ ржЯрзЛржХрзЗржиржЯрж┐ ржмрж╛рждрж┐рж▓ ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗ!");

      // рзй. Token Verify
      const decoded = jwt.verify(
        token,
        process.env.JWT_SECRET as string
      ) as any;

      // рзк. User Exists?
      const user = await prisma.user.findUnique({
        where: { id: decoded.id },
        select: { id: true, role: true, isBanned: true } // рж╢рзБржзрзБ ржпрж╛ ржжрж░ржХрж╛рж░ рждрж╛ ржЖржирзБржи
      });

      if (!user) throw new Error("User not found! | ржЗржЙржЬрж╛рж░ржЯрж┐ ржЦрзБржБржЬрзЗ ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯржирж┐!");
      if (user.isBanned)
        throw new Error( "Your account has been suspended! | ржЖржкржирж╛рж░ ржЕрзНржпрж╛ржХрж╛ржЙржирзНржЯржЯрж┐ рж╕рзНржержЧрж┐ржд ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗ!");

      // рзл. Role Check
      if (Role.length > 0 && !Role.includes(user.role)) {
        return res.status(403).json({
          success: false,
          message: "Access forbidden! You do not have permission | ржПржЗ рж░рзБржЯрзЗ ржЖржкржирж╛рж░ ржкрзНрж░ржмрзЗрж╢рж╛ржзрж┐ржХрж╛рж░ ржирзЗржЗ!",
        });
      }

      // рзм. Attach user to req
      req.user = user;

      next();
    } catch (error: any) {
      res.status(401).json({
        success: false,
        message: error.message || "Authentication failed! | ржЕржерзЗржирзНржЯрж┐ржХрзЗрж╢ржи ржмрзНржпрж░рзНрже рж╣рзЯрзЗржЫрзЗ!",,
      });
    }
  };
};
```

ржирж┐ржЪрзЗ ржзрж╛ржкрзЗ ржзрж╛ржкрзЗ ржПрж░ ржмрзНржпрж╛ржЦрзНржпрж╛ ржжрзЗржУрзЯрж╛ рж╣рж▓рзЛ:

---

### рзз. ржЯрзЛржХрзЗржи рж╕ржВржЧрзНрж░рж╣ (Token Extraction)

```ts
const token = req.headers.authorization?.split(" ")[1];
```

- ржХрзНрж▓рж╛ржпрж╝рзЗржирзНржЯ ржпржЦржи рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржкрж╛ржарж╛рзЯ, рждржЦржи `Authorization` рж╣рзЗржбрж╛рж░ ржерзЗржХрзЗ ржЯрзЛржХрзЗржиржЯрж┐ рж╕ржВржЧрзНрж░рж╣ ржХрж░рж╛ рж╣рзЯред рж╕рж╛ржзрж╛рж░ржгржд ржПржЯрж┐ `Bearer <token>` ржлрж░ржорзНржпрж╛ржЯрзЗ ржерж╛ржХрзЗ, рждрж╛ржЗ `split(" ")[1]` ржжрж┐рзЯрзЗ рж╢рзБржзрзБ ржЯрзЛржХрзЗржи ржЕржВрж╢ржЯрж┐ ржирзЗржУрзЯрж╛ рж╣рзЯред ржЯрзЛржХрзЗржи ржирж╛ ржерж╛ржХрж▓рзЗ ржПрж░рж░ ржерзНрж░рзЛ ржХрж░рзЗред

### рзи. ржмрзНрж▓рзНржпрж╛ржХрж▓рж┐рж╕рзНржЯ ржЪрзЗржХ (Redis Blacklist Check)

```ts
const isBlacklisted = await checkRedisBlacklist(token);
```

- ржПржЯрж┐ ржЕрждрзНржпржирзНржд ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржгред ржЗржЙржЬрж╛рж░ ржпржжрж┐ ржЖржЧрзЗ рж▓ржЧржЖржЙржЯ ржХрж░рзЗ ржерж╛ржХрзЗ, рждржмрзЗ рждрж╛рж░ ржЯрзЛржХрзЗржиржЯрж┐ Redis-ржП ржмрзНрж▓рзНржпрж╛ржХрж▓рж┐рж╕рзНржЯ рж╣рж┐рж╕рзЗржмрзЗ ржЬржорж╛ ржерж╛ржХрзЗред ржпржжрж┐ ржЯрзЛржХрзЗржиржЯрж┐ ржмрзНрж▓рзНржпрж╛ржХрж▓рж┐рж╕рзНржЯрзЗ ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯ, рждржмрзЗ рждрж╛ржХрзЗ ржЖрж░ ржврзБржХрждрзЗ ржжрзЗржУрзЯрж╛ рж╣рзЯ ржирж╛ред

### рзй. ржЯрзЛржХрзЗржи ржнрзЗрж░рж┐ржлрж┐ржХрзЗрж╢ржи (Token Verify)

```ts
const decoded = jwt.verify(token, process.env.JWT_SECRET as string) as any;
```

- ржПржЦрж╛ржирзЗ `jsonwebtoken` рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЪрзЗржХ ржХрж░рж╛ рж╣рзЯ ржпрзЗ ржЯрзЛржХрзЗржиржЯрж┐ ржЖрж╕рж▓ ржХрж┐ ржирж╛ ржПржмржВ ржПрж░ ржорзЗрзЯрж╛ржж ржЖржЫрзЗ ржХрж┐ ржирж╛ред ржЯрзЛржХрзЗржи рж╕ржарж┐ржХ рж╣рж▓рзЗ ржПржЯрж┐ ржбрж┐ржХрзЛржб ржХрж░рзЗ ржЗржЙржЬрж╛рж░рзЗрж░ `id` ржЙржжрзНржзрж╛рж░ ржХрж░рзЗред

### рзк. ржбрж╛ржЯрж╛ржмрзЗржЬрзЗ ржЗржЙржЬрж╛рж░рзЗрж░ ржЕрж╕рзНрждрж┐рждрзНржм ржпрж╛ржЪрж╛ржЗ (User Check)

```ts
const user = await prisma.user.findUnique({ ... });

```

- ржЯрзЛржХрзЗржи рж╕ржарж┐ржХ рж╣рж▓рзЗржУ ржбрж╛ржЯрж╛ржмрзЗржЬрзЗ ржЧрж┐рзЯрзЗ ржЪрзЗржХ ржХрж░рж╛ рж╣рзЯ ржпрзЗ рж╕рзЗржЗ ржЗржЙржЬрж╛рж░ржЯрж┐ ржПржЦржиржУ ржЖржЫрзЗ ржХрж┐ ржирж╛ред ржПржХржЗ рж╕рж╛ржерзЗ ржЗржЙржЬрж╛рж░ **Banned** ржХрж┐ ржирж╛ рждрж╛ржУ ржЪрзЗржХ ржХрж░рж╛ рж╣рзЯред ржпржжрж┐ ржЗржЙржЬрж╛рж░ ржмрзНржпрж╛ржи ржерж╛ржХрзЗ, рждржмрзЗ рждрж╛ржХрзЗ рж░рж┐ржЬрзЗржХрзНржЯ ржХрж░рж╛ рж╣рзЯред

### рзл. рж░рзЛрж▓рзЗ ржмрж╛ ржЕржирзБржорждрж┐ ржпрж╛ржЪрж╛ржЗ (Role Check)

```ts
if (Role.length > 0 && !Role.includes(user.role)) { ... }

```

- ржПржЗ ржорж┐ржбрж▓ржУрзЯрзНржпрж╛рж░ржЯрж┐ ржбрж╛ржЗржирж╛ржорж┐ржХред ржпрзЗржоржи: `authGuard('ADMIN')` рж▓рж┐ржЦрж▓рзЗ ржПржЯрж┐ ржЪрзЗржХ ржХрж░ржмрзЗ ржЗржЙржЬрж╛рж░рзЗрж░ рж░рзЛрж▓ 'ADMIN' ржХрж┐ ржирж╛ред ржпржжрж┐ ржЗржЙржЬрж╛рж░рзЗрж░ рж░рзЛрж▓ ржЕржирзБржорзЛржжрж┐ржд рж░рзЛрж▓рзЗрж░ рждрж╛рж▓рж┐ржХрж╛рзЯ ржирж╛ ржерж╛ржХрзЗ, рждржмрзЗ **403 Forbidden** ржПрж░рж░ ржжрзЗржмрзЗред

### рзм. рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯрзЗ ржЗржЙржЬрж╛рж░ ржбрж╛ржЯрж╛ ржпрзБржХрзНржд ржХрж░рж╛ (Attach to req)

```ts
req.user = user;
next();
```

рж╕ржм ржЪрзЗржХ ржкрж╛рж╕ ржХрж░рж▓рзЗ ржЗржЙржЬрж╛рж░рзЗрж░ рждржерзНржп `req.user` ржП рж╕рзЗржн ржХрж░рзЗ рж░рж╛ржЦрж╛ рж╣рзЯ ржпрж╛рждрзЗ ржкрж░ржмрж░рзНрждрзА ржлрж╛ржВрж╢ржи ржмрж╛ ржХржирзНржЯрзНрж░рзЛрж▓рж╛рж░ржЧрзБрж▓рзЛ ржмрзБржЭрждрзЗ ржкрж╛рж░рзЗ ржХрзЛржи ржЗржЙржЬрж╛рж░ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯржЯрж┐ ржкрж╛ржарж┐рзЯрзЗржЫрзЗред рж╕ржмрж╢рзЗрж╖рзЗ `next()` ржХрж▓ ржХрж░рзЗ ржкрж░рзЗрж░ ржзрж╛ржкрзЗ ржкрж╛ржарж╛ржирзЛ рж╣рзЯред

# _тЬЕ 3) Usage in Routes ржЙржжрж╛рж╣рж░ржг_

```ts
// src/routes/user.routes.ts
import express from "express";
import { authGuard } from "../middleware/authGuard";
import { userController } from "../controllers/user.controller";

const router = express.Router();

router.delete(
  "/delete-system-logs",
  authGuard("super_admin"),
  userController.deleteLogs
);

router.patch(
  "/update-article/:id",
  authGuard("admin", "editor"),
  userController.updateArticle
);

router.get("/me", authGuard(), userController.getMe);

export default router;
```

ржирж┐ржЪрзЗ ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд ржмрзНржпрж╛ржЦрзНржпрж╛ ржжрзЗржУрзЯрж╛ рж╣рж▓рзЛ:

---

### рзз. ржирж┐рж░рзНржжрж┐рж╖рзНржЯ рж░рзЛрж▓рзЗрж░ ржЬржирзНржп ржЕржирзБржорждрж┐ (Super Admin Only)

```ts
router.delete(
  "/delete-system-logs",
  authGuard("super_admin"),
  userController.deleteLogs
);
```

- **ржХрж╛ржЬ:** ржПржЦрж╛ржирзЗ `authGuard` ржП рж╢рзБржзрзБржорж╛рждрзНрж░ `"super_admin"` ржкрж╛рж╕ ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗред
- **ржлрж▓рж╛ржлрж▓:** ржХрзЗржЙ ржпржжрж┐ ржПржЗ рж▓рж┐ржВржХрзЗ ржбрж┐рж▓рж┐ржЯ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржкрж╛ржарж╛рзЯ, рждржмрзЗ ржорж┐ржбрж▓ржУрзЯрзНржпрж╛рж░ржЯрж┐ ржЖржЧрзЗ ржЪрзЗржХ ржХрж░ржмрзЗ рждрж╛рж░ рж░рзЛрж▓рзЗ `super_admin` рж▓рзЗржЦрж╛ ржЖржЫрзЗ ржХрж┐ ржирж╛ред ржпржжрж┐ ржЕржирзНржп ржХрзЗржЙ (ржпрзЗржоржи: `admin` ржмрж╛ `editor`) ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзЗ, рждржмрзЗ рждрж╛ржХрзЗ ржЖржЯржХрзЗ ржжрзЗржУрзЯрж╛ рж╣ржмрзЗред

### рзи. ржПржХрж╛ржзрж┐ржХ рж░рзЛрж▓рзЗрж░ ржЕржирзБржорждрж┐ (Admin + Editor)

```ts
router.patch(
  "/update-article/:id",
  authGuard("admin", "editor"),
  userController.updateArticle
);
```

- **ржХрж╛ржЬ:** ржПржЦрж╛ржирзЗ `authGuard` ржП ржжрзБржЯрж┐ рж░рзЛрж▓ ржжрзЗржУрзЯрж╛ рж╣рзЯрзЗржЫрзЗ: `"admin"` ржПржмржВ `"editor"`ред
- **ржлрж▓рж╛ржлрж▓:** ржПржЗ рж░рзБржЯрзЗ ржЖрж░рзНржЯрж┐ржХрзЗрж▓ ржЖржкржбрзЗржЯ ржХрж░рж╛рж░ ржХрзНрж╖ржорждрж╛ `admin` ржПржмржВ `editor` ржЙржнрзЯрзЗрж░ржЗ ржерж╛ржХржмрзЗред ржЕрж░рзНржерж╛рзО, ржЖржкржирж╛рж░ рж░рзЛрж▓ ржпржжрж┐ ржПржЗ ржжрзБржЯрж┐рж░ ржпрзЗржХрзЛржирзЛ ржПржХржЯрж┐ рж╣рзЯ, рждржмрзЗ ржЖржкржирж┐ ржнрзЗрждрж░рзЗ ржврзБржХрждрзЗ ржкрж╛рж░ржмрзЗржиред

### рзй. рж╕рж╛ржзрж╛рж░ржг рж▓ржЧржЗржи ржЪрзЗржХ (Logged-in User Only)

```ts
router.get("/me", authGuard(), userController.getMe);
```

- **ржХрж╛ржЬ:** ржПржЦрж╛ржирзЗ `authGuard()` ржПрж░ ржнрзЗрждрж░ ржХрзЛржирзЛ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ рж░рзЛрж▓ ржжрзЗржУрзЯрж╛ рж╣рзЯржирж┐ред
- **ржлрж▓рж╛ржлрж▓:** ржПрж░ ржорж╛ржирзЗ рж╣рж▓рзЛ ржЗржЙржЬрж╛рж░ржЯрж┐рж░ ржпрзЗржХрзЛржирзЛ рж░рзЛрж▓ рж╣рждрзЗ ржкрж╛рж░рзЗ, ржХрж┐ржирзНрждрзБ рждрж╛ржХрзЗ ржЕржмрж╢рзНржпржЗ **рж╕ржарж┐ржХржнрж╛ржмрзЗ рж▓ржЧржЗржи ржХрж░рж╛** ржерж╛ржХрждрзЗ рж╣ржмрзЗ ржПржмржВ рждрж╛рж░ ржЯрзЛржХрзЗржиржЯрж┐ ржнрзНржпрж╛рж▓рж┐ржб рж╣рждрзЗ рж╣ржмрзЗред рж╕рж╛ржзрж╛рж░ржгржд ржкрзНрж░рзЛржлрж╛ржЗрж▓ ржжрзЗржЦрж╛рж░ ржЬржирзНржп ржПржЯрж┐ ржмрзНржпржмрж╣рзГржд рж╣рзЯред

---

### ржХрж╛ржЬрзЗрж░ ржкрзНрж░ржмрж╛рж╣ (Visual Representation)

ржирж┐ржЪрзЗрж░ ржбрж╛рзЯрж╛ржЧрзНрж░рж╛ржоржЯрж┐ рж▓ржХрзНрж╖рзНржп ржХрж░рж▓рзЗ ржмрзБржЭрждрзЗ ржкрж╛рж░ржмрзЗржи ржХрзАржнрж╛ржмрзЗ `authGuard` рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯржЯрж┐ржХрзЗ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рзЗ:

---

### ржХрзЗржи ржПржЗ ржкржжрзНржзрждрж┐ржЯрж┐ рж╕рзЗрж░рж╛?

| ржмрзИрж╢рж┐рж╖рзНржЯрзНржп      | рж╕рзБржмрж┐ржзрж╛                                                                                                       |
| -------------- | ------------------------------------------------------------------------------------------------------------ |
| **Reusable**   | ржПржХржЗ `authGuard` рж╕ржм ржЬрж╛рзЯржЧрж╛рзЯ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржпрж╛ржЪрзНржЫрзЗред                                                                |
| **Scalable**   | ржнржмрж┐рж╖рзНржпрждрзЗ ржирждрзБржи ржХрзЛржирзЛ рж░рзЛрж▓ (ржпрзЗржоржи: `moderator`) ржЖрж╕рж▓рзЗ рж╢рзБржзрзБ ржкрзНржпрж╛рж░рж╛ржорж┐ржЯрж╛рж░рзЗ ржирж╛ржо рж▓рж┐ржЦрзЗ ржжрж┐рж▓рзЗржЗ рж╣ржмрзЗред                        |
| **Clean Code** | ржХржирзНржЯрзНрж░рзЛрж▓рж╛рж░рзЗрж░ ржнрзЗрждрж░ ржмрж╛рж░ржмрж╛рж░ рж░рзЛрж▓ ржЪрзЗржХ ржХрж░рж╛рж░ ржХрзЛржб рж▓рж┐ржЦрждрзЗ рж╣ржЪрзНржЫрзЗ ржирж╛, рж░рж╛ржЙржЯ ржлрж╛ржЗрж▓рзЗ ржжрзЗржЦрзЗржЗ ржмрзЛржЭрж╛ ржпрж╛ржЪрзНржЫрзЗ ржХрзЗ ржХрзЛржерж╛рзЯ ржврзБржХрждрзЗ ржкрж╛рж░ржмрзЗред |
